<div><span style="font-size: 13px;">This research is published in <i>IEEE Transactions on Instrumentation and Measurement</i>. The title of paper is <i>Automatic Visual Detection System of Railway Surface Defects With Curvature Filter and Improved Gaussian Mixture Model</i>.&nbsp;</span></div><div><br /></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">If you find any useful in your research, please consider citing:</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">@article{zhang2018automatic,</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">title={Automatic Visual Detection System of Railway Surface Defects With Curvature Filter and Improved Gaussian Mixture Model},</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">author={Zhang, Hui and Jin, Xiating and Wu, QM Jonathan and Wang, Yaonan and He, Zhendong and Yang, Yimin},</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">journal={IEEE Transactions on Instrumentation and Measurement},</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">volume={67},</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">number={7},</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">pages={1593--1608},</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">year={2018},</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">publisher={IEEE}</span></div><div><span style="font-size: 13px; font-family: Arial; background-color: rgb(255, 255, 255);">}</span></div><div><br /></div><div><span style="font-size: 32px;"><b style="font-size: 24px;">Abstract</b></span></div><div><span style="color: rgb(51, 51, 51); font-family: Arial; font-size: 13px;">Rails are among the most important components of railway transportation, and real-time defects detection of the railway is an important and challenging task because of intensity inhomogeneity, low contrast, and noise. This paper presents an automatic railway visual detection system (RVDS) for surface defects and focuses on several key issues of RVDS. First, in view of challenges such as complex condition and orbital reflectance inequality, we put forward a region-of-interest detection region extraction algorithm by vertical projection and gray contrast algorithm. In addition, a curvature filter equipped with implicit computing and surface preserving power is studied to eliminate noise and keep only the details. Then, an improved fast and robust Gaussian mixture model based on Markov random field is established for accurate and rapid surface defect segmentation. Additionally, an expectation-maximization algorithm is applied to optimize the parameters. The experimental results demonstrate that the proposed method performs well with both noisy and railway images, which enables identification and segmentation of the defects from rail surface, achieving detection performance with 92% precision and 88.8% recall rate on average, and is robust compared with the related well-established approaches.</span></div><div><b style="font-size: 24px;"><br /></b></div><div><span style="font-size: 24px;"><b>Experiment and Analysis</b></span></div><div><span style="color: rgb(51, 51, 51); font-family: Arial; font-size: 13px;">To evaluate the performance of the proposed algorithm, it was implemented in the MATLAB R2017a programming environment on a PC with Intel(R) Core(TM) i5–7200 CPU at 2.50-GHz running Windows 10.&nbsp;The system adopts a DalsaSpyder3 line-scan camera with a resolution of 1024 pixels for image capture. Its maximum line rate is 68 000 lines/s, which can capture a set of frames and finally generates a panorama.</span></div><div><span style="color: rgb(51, 51, 51); font-family: Arial; font-size: 13px;"><br /></span></div><div><span style="color: rgb(51, 51, 51); font-family: Arial; font-size: 18px;"><b>A. Image Preprocessing</b></span></div><div><div><span style="font-family: Arial; font-size: 16px;"><b>1) ROI Extraction:</b></span></div><div><span style="font-family: Arial; font-size: 13px;">The original image acquired by the camera (for a rail scene image) also includes other backgrounds in addition to the rail. To reduce the detection range and avoid the redundant operation of the following processing, we conduct an extraction algorithm based on the gray vertical projection, extract the valuable rail area R(x,y) from the scene image I(x,y) , and form the detection ROI area.</span></div></div><div><div><span style="font-family: Arial; font-size: 16px;"><b>2) Gray Equalization:</b></span></div><div><span style="color: rgb(51, 51, 51); font-family: Arial; font-size: 13px;">Observing the rail area R, we found that surface defects are submerged in a large volume of noise. Note that the noise is generated by the compound conditions such as natural and nonnatural light, train mechanical vibration, rail geometry, and orbital reflector material. These corruptions are mainly reflected on the rail image, where the steel surface appears alternately as light and dark, resulting in defects difficult to distinguish from the railroad background. Therefore, in order to eliminate the interference of inherent noise, the second step of image preprocess is gray equalization for rail region R, making the defect more obvious on the surface of railway.&nbsp;</span></div><div><img src="https://mail.163.com/js6/s?func=mbox:getComposeData&amp;sid=QAUTqGDCheCIZDEOoeCCkgZoqpBvvOBA&amp;composeId=c:1540642359418&amp;attachId=3&amp;rnd=0.9379024644942149" orgwidth="160" orgheight="250" data-image="1" style="width: 105px; height: 164.7px; border: none;" /></div><div><h3 style="font-size: 1.145em; line-height: 1.3; margin: 0px 0px 0.5em; color: rgb(51, 51, 51); font-family: Georgia, serif; outline: 0px !important;"><span style="font-family: Arial; font-size: 18px;">B. Curvature Filter</span></h3></div><div><h4 style="font-size: 0.93em; line-height: 1.3; margin: 0px 0px 0.1em; color: rgb(51, 51, 51); font-family: Georgia, serif;"><span style="font-family: Arial; font-size: 16px;">1) Filter of the Natural Real Images:</span></h4><p style="margin: 0px 0px 1.5em; font-family: Georgia, serif; font-size: 15px; outline: 0px !important;"><span style="font-family: Arial; font-size: 13px;"><font color="#333333">We use the sample 3 for testing. Fig. 2&nbsp;</font></span><span style="color: rgb(51, 51, 51); font-family: Arial; font-size: 13px;">is the real image of the filtering results and energy evolution. To facilitate observation, we magnify the image details in four images, namely, four typical representations: regular defects (red box), irregular defects (green box), rough rail surface (blue box), and smooth rail surface (yellow box). We find that: 1) although Gc, Mc, and V are not very different, corresponding Gaussian curvature energies are 246.98, 102.4, and 97.15, and thus the effectiveness of curvature filter can be seen and 2) comparing Gc with V, curvature filter can work alone or work with a data fitting (imaging model). It does not require a gradient to calculate the imaging model, which makes it very versatile.</span></p></div></div><div><h4 style="font-size: 0.93em; line-height: 1.3; margin: 0px 0px 0.1em; color: rgb(51, 51, 51); font-family: Georgia, serif;"><span style="font-family: Arial; font-size: 16px;">2) Other Samples’ Results:</span></h4><p style="margin: 0px 0px 1.5em; color: rgb(51, 51, 51); font-family: Georgia, serif; font-size: 15px; outline: 0px !important;"><span style="font-size: 13px; font-family: Arial;">In Fig. 3,&nbsp;we use the curvature filter to filter the other samples. The experimental results verify the correctness of the qualitative evaluation of each of the curvature filters.</span></p></div><div><h4 style="font-size: 0.93em; line-height: 1.3; margin: 0px 0px 0.1em; color: rgb(51, 51, 51); font-family: Georgia, serif; outline: 0px !important;"><span style="font-family: Arial; font-size: 16px;">3) Performance Comparison and Statistics:</span></h4><p style="margin: 0px 0px 1.5em; color: rgb(51, 51, 51); font-family: Georgia, serif; font-size: 15px;"><span style="font-family: Arial; font-size: 13px;">Next, samples 1–5 were tested using various filters. The experimental results are presented in&nbsp;</span><a ref-type="table" anchor="table1" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">Table I</span></a><span style="font-family: Arial; font-size: 13px;">. In the table, we mark some of the better performance data, where the red marker data belong to our curvature filter and the green marker data belong to the other filters. We find the following.</span></p><p style="margin: 0px 0px 1.5em; color: rgb(51, 51, 51); font-family: Georgia, serif; font-size: 15px;"><span style="font-family: Arial; font-size: 13px;">1. Our filter in the various types of samples on the test to occupy most of the advantages of data.</span></p><p style="margin: 0px 0px 1.5em; color: rgb(51, 51, 51); font-family: Georgia, serif; font-size: 15px;"><span style="font-family: Arial; font-size: 13px;">2. In samples 1–3, due to retaining the image of the surface or the smallest surface, the SNR and peak SNR (PSNR) of our filter are higher than other filters. Because of the implicit calculation of the curvature of the regular term, the time cost of our filter is 10 to 1000 times less than most filters.</span></p><p style="margin: 0px 0px 1.5em; color: rgb(51, 51, 51); font-family: Georgia, serif; font-size: 15px;"><span style="font-family: Arial; font-size: 13px;">3. In samples 4 and 5, our filter loses the advantage over other filters and only Gc runs fast. In summary, due to the implicit calculation and the retention of the unique surface, our filter makes the denoising performance and image recovery capability better, the time cost and the convergence step are small, and the calculation speed is faster than other filters 1–3 orders of magnitude; reflecting the curvature filter algorithm is fast, accurate, and easy to implement. However, these advantages are not found in similar samples 4 and 5, whose overall grayscale values of images are minimal.</span></p><h3 style="font-size: 1.145em; line-height: 1.3; margin: 0px 0px 0.5em; color: rgb(51, 51, 51); font-family: Georgia, serif; outline: 0px !important;"><span style="font-family: Arial; font-size: 18px;">C. Improved Gaussian Mixture Model Based on MRF</span></h3></div><div><p style="margin: 0px 0px 1.5em; color: rgb(51, 51, 51); font-family: Georgia, serif; font-size: 15px;"><span style="font-family: Arial; font-size: 13px;">In the following experiment, we first use this method to segment the filtered image, and then test the temperature coefficient&nbsp;</span><inline-formula id=""><span style="display: inline; line-height: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; font-family: Arial; font-size: 13px;"><nobr style="transition: none 0s ease 0s; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px; line-height: normal;"><span class="math" id="MathJax-Span-5531" style="font-size: 13px; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; font-family: Arial; transition: none 0s ease 0s; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; line-height: normal; box-sizing: content-box; width: 0.544em;"><span style="font-size: 13px; width: 0.483em; height: 0px; display: inline; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; font-family: Arial; transition: none 0s ease 0s; position: absolute; padding: 0px; margin: 0px; vertical-align: 0px; line-height: normal; box-sizing: content-box; clip: rect(1.745em, 1000.48em, 2.946em, -999.997em); top: -2.58em; left: 0em;"><span class="mrow" id="MathJax-Span-5532" style="font-size: 13px; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; font-family: Arial; transition: none 0s ease 0s; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; line-height: normal; box-sizing: content-box;">β<span style="font-size: 13px; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; font-family: Arial; transition: none 0s ease 0s; display: inline-block; position: static; padding: 0px; margin: 0px; vertical-align: 0px; line-height: normal; box-sizing: content-box; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="border: 0px; font-size: 13px; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; font-family: Arial; transition: none 0s ease 0s; display: inline-block; position: static; padding: 0px; margin: 0px; vertical-align: 0px; line-height: normal; box-sizing: content-box; width: 0px; height: 2.586em;"></span></span><span style="font-size: 13px; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; font-family: Arial; transition: none 0s ease 0s; display: inline-block; position: static; padding: 0px; margin: 0px; vertical-align: -0.263em; line-height: normal; box-sizing: content-box; overflow: hidden; width: 0px; height: 1.137em;"></span></span></nobr></span><span style="font-family: Arial; font-size: 13px;">&nbsp;</span></inline-formula><span style="font-family: Arial; font-size: 13px;">of the proposed method, and finally compared with other segmentation methods. Our method uses the standard GMM to initialize, so&nbsp;</span><a ref-type="sec" anchor="sec4c1" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">Sections IV-C1</span></a><a ref-type="sec" anchor="sec4c2" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">–</span></a><a ref-type="sec" anchor="sec4c3" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">IV-C3</span></a><span style="font-family: Arial; font-size: 13px;">&nbsp;in the standard GMM with our method to form a qualitative evaluation comparison. However, the other contrast experiment and more intuitive quantitative assessment are shown in&nbsp;</span><a ref-type="sec" anchor="sec4c4" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">Sections IV-C4</span></a><span style="font-family: Arial; font-size: 13px;">.</span></p><div class="section_2" id="sec4c1" style="outline: 0px !important;"><h4 style="color: rgb(51, 51, 51); font-family: Georgia, serif; font-size: 0.93em; line-height: 1.3; margin: 0px 0px 0.1em;"><span style="font-family: Arial; font-size: 16px;">1) Sample Segmentation Test:</span></h4><p style="color: rgb(51, 51, 51); font-family: Georgia, serif; font-size: 15px; margin: 0px 0px 1.5em; outline: 0px !important;"><a ref-type="fig" anchor="fig12" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">Fig. 12</span></a><span style="font-family: Arial; font-size: 13px;">&nbsp;shows the segmentation result for sample 1. As shown in&nbsp;</span><a ref-type="fig" anchor="fig12" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">Fig. 12(a)</span></a><span style="font-family: Arial; font-size: 13px;">, the filtered image includes defects, rails, noise, and other information, and the purpose is to divide the image into two categories: defective area and nondefective areas, and the difficulty lies in the boundaries between the two classes. As shown in&nbsp;</span><a ref-type="fig" anchor="fig12" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">Fig. 12(b)</span></a><span style="font-family: Arial; font-size: 13px;">, although the standard GMM effectively classifies the defect, at the same time to separate a number of noise and part of the rail surface is difficult, standard GMM will cause serious misclassification, because it is sensitive to noise. In&nbsp;</span><a ref-type="fig" anchor="fig12" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">Fig. 12(c)</span></a><span style="font-family: Arial; font-size: 13px;">, our method has a good segmentation effect, accurately classifying the image into defective and nondefective classes and suppressing a significant amount of noise, indicating that the robustness to noise is excellent.&nbsp;</span><a ref-type="fig" anchor="fig12" class="fulltext-link" style="background: 0px 0px; color: rgb(0, 102, 153); cursor: pointer; text-decoration: underline; font-family: Arial; font-size: 13px;"><span style="font-family: Arial; font-size: 13px;">Fig. 12(d)</span></a><span style="font-family: Arial; font-size: 13px;">&nbsp;is the logarithmic probability maximization process; the method can converge quickly after five iterations. It shows that our method optimizes the parameters directly by using the EM algorithm, which is faster, more accurate, and easier to implement than other methods.</span></p><p style="margin: 0px 0px 1.5em; outline: 0px !important;"><font color="#333333"><span style="font-size: 16px;"><b>2) Temperature Coefficient β Test:</b></span></font></p><p style="margin: 0px 0px 1.5em; outline: 0px !important;"><span style="font-size: 13px; color: rgb(51, 51, 51);">Fig. 13 shows the segmentation result of our method under different temperature values β=2,4,6,8,12,16,20 . By taking a closer look, it can be visualized that when β is smaller, the sharpness and details of defects lose less, but a large volume of noise remains, which is shown in Fig. 13(a2), (a3), (b2), and (b3). Additional, our method is robust but easier to lose details in the case of a larger β , which is shown in Fig. 13(a8) and (b8). In a word, β is chosen small enough to prevent from losing much sharpness and details but misclassify, and β is chosen large enough to tolerate noise but result in a low accuracy.</span></p></div></div><div><div><span style="font-size: 16px;"><b>3) Performance Comparison for Other Samples:</b></span></div><div><span style="font-size: 13px;">The test of Sections IV-C1 and IV-C2 verifies the feasibility of using the MRF GMM for defect segmentation but does not reflect the superiority of the algorithm. Therefore, we then use K -mean, GMM, FCM, FFCM, and Student-T MM classical clustering method. A comparative experiment was conducted on five samples, and we use the misclassification rate (MCR), Rand index (RI), PSNR, mean square error, variation of information (VI), time cost (Time), and global consistency error (GCE) to analyze of segmentation performance quantitatively.</span></div><div><span style="font-size: 13px;">Fig. 14 shows the results of the comparative experiment. Since our sample is an unmarked rail image, the ground truth is replaced by manual segmentation. Table II records the performance data for the various methods with samples 1–5. In Table II, we mark some of the better performance information, where the red marker data belong to our method and the green marker data belong to other methods. It is worth noting that when the MCR, RMSE, VI, and GCE are smaller, PSNR, NPR, and PRI are larger, indicating that the segmentation quality is better. In contrast, we find the following.</span></div><div><span style="font-size: 13px;">1. Our method works well in all segmentation tests of various samples.</span></div><div><span style="font-size: 13px;">2. Regardless of the existence of special cases, segmentation results of K -means, GMM, FCM, FFCM, and Student-T show very serious misclassification and much residual noise, resulting in their MCR, VI, and GCE being very high and RI and PSNR being very low; in contrast, our method is effective.</span></div><div><span style="font-size: 13px;">3. Since our method can directly use the EM algorithm to optimize the logarithmic probability, the other methods, such as MCR, VI, and GCE are deficient, and RI and PSNR are very high.</span></div></div><div><span style="font-size: 16px;"><b><br /></b></span></div><div><span style="font-size: 16px;"><b>4) Quantitative Analysis of Defects Detection:</b></span></div><div><span style="font-size: 13px;">The defect detection performance is verified using the obtained experimental data in Sections IV-A and IV-B, and the quantitative indexes are listed in Table III with each row corresponding to different defects types and illumination. We have achieved a very good performance with 92% recall and 88.8% precision rates. As evident, most oblong defects similar to sample 1 are easily detected with the proposed algorithm, even though some exceptions might happen to tiny and ambiguous defects or the very noisy interferences are occasionally discriminated as defects. Moreover, the algorithm has achieved the best performance for block-type detects with 92.4% precision and 87.6% recall rates. The errors are mainly due to the largely varying gray-level distribution of the background. In the block-type defects, there are quite a few FP error defects in Fig. 14 samples 2 and 5. The primary reason is that segmentation is wrongly taken as a block area, which causes abrupt gray-level changes in projection profiles. Moreover, the small defects near the region boundaries are occasionally considered as defects. With the proposed method, all the critical and major defects, including oblong, block, square, and so on, are easily detected. The main errors are the small, ambiguous defects or the noisy background.</span></div><div><b style="font-size: 24px;"><br /></b></div><div><b style="font-size: 24px;">Conclusion</b></div><div><span style="color: rgb(51, 51, 51); font-family: Arial; font-size: 13px;">In this paper, a visual detection method for rail surface defect using curvature filter and improved GMM is proposed. The first step is image preprocessing, including rail surface extraction and gray equalization. An extraction algorithm based on vertical projection is used to capture the rail surface image from original scene image. For gray equalization, the contrast image is acquired from gray contrast algorithm to handle problems such as illumination inequality and orbital reflectance inequality. We take advantage of the implicit calculation and differential geometry of three curvature filters, so that Gc, Mc, and V enable removal of noise while retaining the details and maintaining the developable surface or minimal surface of an image. In order to segment the surface defect rapidly, accurately and robustly, we propose a new way to incorporate spatial information between neighboring pixels into the GMM based on MRF. Distinct from other mixture models, the EM algorithm in our model could be directly applied to the prior distribution for maximization of the log-likelihood function. In the experiment, the applied curvature filters achieve higher PSNRs and are 10 to 1000 times faster than other filters; the proposed mixture model performs well with the average rate on precision (88.8%), recall (92.0%), and computational time (1.04 frame/s), which is also 10 to 1000 times faster than other approaches. The results demonstrate that the proposed combined filter and MRF-based detection system can not only enhance the capability of RVDS in faint defects but also reduce the processing time cost. The qualitative and quantitative results indicate that the method is effective and efficient in railway track defects detection.</span></div><div><br /></div>
